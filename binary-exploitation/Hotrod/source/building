# Building

## Get and Build 5.8.3

Bash
$ wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.8.3.tar.xz
$ tar -xvf linux-5.8.3.tar.xz
$ pushd linux-5.8.3
$ make allnoconfig
$ cp ../kernel_config .config
$ KBUILD_BUILD_TIMESTAMP='Sun August 26 12:00:00 UTC 2020' KBUILD_BUILD_USER=professor_stallman KBUILD_BUILD_HOST=youtu.be/dQw4w9WgXcQ make -j$(nproc)
$ popd


## Build the Module

Bash
build it elsewhere in a diff directory so it doesn't leak your directories
$ make -C linux-5.8.3/ M=(pwd)


## Clean the Directory

Bash
$ make -C linux-5.8.3/ M=(pwd) clean

compiling your own kernel

CONFIG_STACKPROTECTOR=y
CONFIG_STACKPROTECTOR_STRONG=y
CONFIG_SLAB_FREELIST_RANDOM=y
CONFIG_SLAB_FREELIST_HARDENED=y
CONFIG_SHUFFLE_PAGE_ALLOCATOR=y
CONFIG_DEFAULT_MMAP_MIN_ADDR=0 # for a non obvious null ptr deref
CONFIG_RANDOMIZE_BASE=y
CONFIG_RANDOMIZE_MEMORY=y
CONFIG_PAGE_TABLE_ISOLATION=y


64-bit kernel ---> yes
Enable loadable module support ---> yes
General setup ---> Initial RAM filesystem and RAM disk (initramfs/initrd) support ---> yes
General setup ---> Configure standard kernel features ---> Multiple users, groups and capabilities support ---> yes
General setup ---> Configure standard kernel features ---> Sysfs syscall support ---> yes
General setup ---> Configure standard kernel features ---> Enable support for printk ---> yes
General setup ---> Configure standard kernel features ---> Load all symbols for debugging/ksymoops ---> yes
General setup ---> Configure standard kernel features ---> Include all symbols in kallsyms ---> yes
Executable file formats / Emulations ---> Kernel support for ELF binaries ---> yes
Executable file formats / Emulations ---> Kernel support for scripts starting with #! ---> yes
Binary Emulations ---> IA32 Emulations ---> yes
Binary Emulations ---> IA32 a.out support ---> yes
Binary Emulations ---> IA32 ABI for 64-bit mode ---> yes
Device Drivers ---> Generic Driver Options ---> Maintain a devtmpfs filesystem to mount at /dev ---> yes
Device Drivers ---> Generic Driver Options ---> Automount devtmpfs at /dev, after the kernel mounted the rootfs ---> yes
Device Drivers ---> Character devices ---> Enable TTY ---> yes
Device Drivers ---> Character devices ---> Serial drivers ---> 8250/16550 and compatible serial support ---> yes
Device Drivers ---> Character devices ---> Serial drivers ---> Console on 8250/16550 and compatible serial port ---> yes
File systems ---> Pseudo filesystems ---> /proc file system support ---> yes
File systems ---> Pseudo filesystems ---> sysfs file system support ---> yes